* What?

1. =nix-shell= to =ghcHEAD= (or any other compiler of choice) with:
2. https://github.com/hvr/head.hackage patches applied
3. Custom package pins & overrides
4. Nixpkgs pinning

* How?

*** Quick setup (Nix assumed installed)

    : git clone --recurse-submodules https://github.com/deepfire/nix-head

    ..or, equivalently:

    : git clone https://github.com/deepfire/nix-head
    : ./update-head-hackage.sh

    ..and then:

    : cd nix-head
    : nix-shell --no-build-output --cores 0 -j4

    ..which will give you a shell with =ghcHEAD= and =cabal-install= (by default).

*** Choosing desired packages

    : nix-shell --arg pkgs '["aeson" "cabal-install"]'    # Defaults to just 'cabal-install'

*** Changing Nixpkgs pin

    : ./pin-nixpkgs.sh REVISION [GITHUB-USERNAME]

*** Setting a package pin

    : ./pin-package.sh GITHUB-USERNAME HASKELL-ATTRIBUTE [COMMIT-ID]
    ..then add a line to =extra-overrides.nix=:
    : aeson = { pin = true; };

    Other overrides can be conveniently specified there:

#+BEGIN_SRC nix
{ pin ? false        :: Bool            # Override the repo/commit from pins/${x}-src.json; see ./pin.sh
, repo ? attr        :: String          # When repository name != attribute name
, chdir ? null       :: Filepath        # When package's cabal file is in subdir of repository
, revision ? (!pin)  :: Bool            # Set to false to disable edited cabal file & revision
, patch ? null       :: Maybe PatchSpec # Argument to fetchpatch
, jailbreak ? false  :: Bool
, doHaddock ? true   :: Bool
, doCheck ? true     :: Bool
}
#+END_SRC


*** Choosing GHC package set

    : nix-shell --argstr compiler ghc863
